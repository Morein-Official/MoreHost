<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SkyNexaHost</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    *{margin:0;padding:0;box-sizing:border-box;}
    body{font-family:'Poppins',sans-serif;background:#0a0a0a;color:white;}

    /* LOADING */
    #loadingScreen{position:fixed;top:0;left:0;width:100%;height:100%;
      background:linear-gradient(135deg,#1e3c72,#2a5298);
      display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:2000;}
    .loading-logo{font-size:48px;font-weight:700;background:linear-gradient(90deg,red,orange,yellow,green,cyan,blue,violet);
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:glow 2s infinite alternate;}
    @keyframes glow{from{text-shadow:0 0 5px #fff;}to{text-shadow:0 0 20px #fff,0 0 40px #0ff;}}
    .loading-bar{width:200px;height:8px;border-radius:8px;background:rgba(255,255,255,0.2);margin-top:20px;overflow:hidden;}
    .loading-fill{width:0;height:100%;background:linear-gradient(90deg,#00ffea,#00aaff);animation:fill 4s forwards;}
    @keyframes fill{to{width:100%;}}

    /* AUTH */
    #auth,#dashboard,#workspace,#previewArea{display:none;}
    #auth{height:100vh;display:flex;align-items:center;justify-content:center;
      background:linear-gradient(135deg,#0f0c29,#302b63,#24243e);}
    #authCard{background:rgba(255,255,255,0.05);padding:40px;border-radius:16px;
      box-shadow:0 0 25px rgba(0,0,0,0.6);text-align:center;backdrop-filter:blur(8px);}
    #authCard h2{margin-bottom:20px;color:#00ffea;}
    #authCard input{width:100%;margin:8px 0;padding:10px;border:none;border-radius:8px;}
    #authCard button{width:48%;margin:10px 1%;}

    /* BUTTONS */
    button{background:#111;border:2px solid #00ffea;color:#00ffea;padding:10px 20px;border-radius:8px;
      cursor:pointer;transition:all 0.3s;}
    button:hover{background:linear-gradient(90deg,red,orange,yellow,green,cyan,blue,violet);
      color:#111;box-shadow:0 0 20px #fff;transform:scale(1.05);}

    /* DASHBOARD */
    #dashboard{text-align:center;padding:20px;position:relative;}
    #logoutBtn{position:absolute;top:10px;right:10px;font-size:12px;padding:6px 12px;}
    #newProjectBtn{margin-top:40px;display:block;margin-left:auto;margin-right:auto;}
    #readyCodesBtn{margin-top:20px;background:linear-gradient(90deg,red,orange,yellow,green,cyan,blue,violet);
      -webkit-background-clip:text;-webkit-text-fill-color:transparent;border-color:transparent;font-weight:bold;}
    #projects{margin-top:20px;display:flex;flex-wrap:wrap;justify-content:center;gap:20px;}
    .project-box{background:rgba(255,255,255,0.05);padding:20px;border-radius:12px;width:200px;text-align:center;}

    /* WORKSPACE */
    #workspace{height:100vh;display:flex;}
    #sidebar{width:200px;background:rgba(255,255,255,0.05);padding:10px;}
    #fileList{list-style:none;margin-top:10px;}
    #fileList li{padding:6px;cursor:pointer;border-radius:6px;}
    #fileList li:hover{background:rgba(255,255,255,0.1);}
    #editorArea{flex:1;display:flex;flex-direction:column;}
    #editor{flex:1;}
    #editorArea button{margin:5px;}

    /* PREVIEW */
    #previewArea{position:fixed;top:0;left:0;width:100%;height:100%;background:#000;display:none;z-index:1500;}
    #previewFrame{width:100%;height:100%;border:none;}
  </style>
</head>
<body>
  <!-- LOADING -->
  <div id="loadingScreen">
    <div class="loading-logo">SkyNexaHost</div>
    <div class="loading-bar"><div class="loading-fill"></div></div>
  </div>

  <!-- AUTH -->
  <div id="auth">
    <div id="authCard">
      <h2>Welcome to SkyNexaHost</h2>
      <input type="text" id="username" placeholder="Username">
      <input type="password" id="password" placeholder="Password">
      <div>
        <button id="signUpBtn">Sign Up</button>
        <button id="logInBtn">Log In</button>
      </div>
    </div>
  </div>

  <!-- DASHBOARD -->
  <div id="dashboard">
    <button id="logoutBtn">Logout</button>
    <h2>Dashboard</h2>
    <button id="newProjectBtn">+ New Project</button>
    <button id="readyCodesBtn">Ready Codes</button>
    <div id="projects"></div>
  </div>

  <!-- WORKSPACE -->
  <div id="workspace">
    <div id="sidebar">
      <button id="addFileBtn">+ Add File</button>
      <ul id="fileList"></ul>
    </div>
    <div id="editorArea">
      <div style="display:flex;justify-content:space-between;">
        <button id="saveBtn">Save</button>
        <button id="previewBtn">Preview</button>
      </div>
      <div id="editor" style="width:100%;height:100%;"></div>
    </div>
  </div>

  <!-- PREVIEW -->
  <div id="previewArea">
    <iframe id="previewFrame"></iframe>
    <button id="closePreviewBtn" style="position:absolute;top:10px;right:10px;">Close</button>
  </div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.32.0/ace.js"></script>
<script>
  // LOADING
  window.onload=()=>{
    setTimeout(()=>{
      document.getElementById('loadingScreen').style.display='none';
      if(localStorage.getItem('skynexa_loggedIn')) showDashboard();
      else document.getElementById('auth').style.display='flex';
    },4000);
  };

  // AUTH
  function signUp(){
    let u=document.getElementById('username').value.trim();
    let p=document.getElementById('password').value.trim();
    if(!u||!p){alert('Enter username and password');return;}
    if(localStorage.getItem('skynexa_user_'+u)){alert('User already exists');return;}
    localStorage.setItem('skynexa_user_'+u,JSON.stringify({password:p,projects:{}}));
    localStorage.setItem('skynexa_loggedIn',u);
    showDashboard();
  }
  function logIn(){
    let u=document.getElementById('username').value.trim();
    let p=document.getElementById('password').value.trim();
    let data=localStorage.getItem('skynexa_user_'+u);
    if(!data){alert('User not found');return;}
    let parsed=JSON.parse(data);
    if(parsed.password!==p){alert('Wrong password');return;}
    localStorage.setItem('skynexa_loggedIn',u);
    showDashboard();
  }
  function logout(){
    localStorage.removeItem('skynexa_loggedIn');
    document.getElementById('dashboard').style.display='none';
    document.getElementById('workspace').style.display='none';
    document.getElementById('auth').style.display='flex';
  }

  // DASHBOARD
  function showDashboard(){
    document.getElementById('auth').style.display='none';
    document.getElementById('workspace').style.display='none';
    document.getElementById('dashboard').style.display='block';
    loadProjects();
  }
  function createProject(name){
    let u=localStorage.getItem('skynexa_loggedIn');
    let user=JSON.parse(localStorage.getItem('skynexa_user_'+u));
    if(user.projects[name]){alert('Project already exists');return;}
    user.projects[name]={}; // Empty initially
    localStorage.setItem('skynexa_user_'+u,JSON.stringify(user));
    openProject(name);
  }
  function loadProjects(){
    let u=localStorage.getItem('skynexa_loggedIn');
    let user=JSON.parse(localStorage.getItem('skynexa_user_'+u));
    let container=document.getElementById('projects');
    container.innerHTML='';
    for(let p in user.projects){
      let box=document.createElement('div');
      box.className='project-box';
      box.textContent=p;
      box.onclick=()=>openProject(p);
      container.appendChild(box);
    }
  }

  // WORKSPACE
  let currentProject=null;
  let currentFile=null;
  let editor;

  function openProject(name){
    document.getElementById('dashboard').style.display='none';
    document.getElementById('workspace').style.display='flex';
    currentProject=name;
    let u=localStorage.getItem('skynexa_loggedIn');
    let user=JSON.parse(localStorage.getItem('skynexa_user_'+u));
    let fileList=document.getElementById('fileList');
    fileList.innerHTML='';
    for(let f in user.projects[name]){
      let li=document.createElement('li');
      li.textContent=f;
      li.onclick=()=>openFile(f);
      fileList.appendChild(li);
    }
    editor=ace.edit("editor");
    editor.setTheme("ace/theme/monokai");
    editor.session.setMode("ace/mode/html");
    editor.setValue("");
  }

  function addFile(){
    let fname=prompt('File name? (index.html / style.css / script.js)');
    if(!fname)return;
    if(!fname.endsWith('.html')&&!fname.endsWith('.css')&&!fname.endsWith('.js')){
      alert('Only .html, .css, .js allowed');return;
    }
    let u=localStorage.getItem('skynexa_loggedIn');
    let user=JSON.parse(localStorage.getItem('skynexa_user_'+u));
    if(user.projects[currentProject][fname]){
      alert('File already exists');return;
    }
    user.projects[currentProject][fname]="";
    localStorage.setItem('skynexa_user_'+u,JSON.stringify(user));
    let li=document.createElement('li');
    li.textContent=fname;
    li.onclick=()=>openFile(fname);
    document.getElementById('fileList').appendChild(li);
    openFile(fname);
  }

  function openFile(fname){
    currentFile=fname;
    let u=localStorage.getItem('skynexa_loggedIn');
    let user=JSON.parse(localStorage.getItem('skynexa_user_'+u));
    editor.setValue(user.projects[currentProject][fname]);
    if(fname.endsWith('.css')) editor.session.setMode("ace/mode/css");
    else if(fname.endsWith('.js')) editor.session.setMode("ace/mode/javascript");
    else editor.session.setMode("ace/mode/html");
  }

  function saveFile(){
    if(!currentFile){alert('Please create a file first');return;}
    let u=localStorage.getItem('skynexa_loggedIn');
    let user=JSON.parse(localStorage.getItem('skynexa_user_'+u));
    user.projects[currentProject][currentFile]=editor.getValue();
    localStorage.setItem('skynexa_user_'+u,JSON.stringify(user));
    alert('File saved');
  }

  function previewProject(){
    let u=localStorage.getItem('skynexa_loggedIn');
    let user=JSON.parse(localStorage.getItem('skynexa_user_'+u));
    let proj=user.projects[currentProject];
    if(!proj["index.html"]){alert('index.html required');return;}
    let html=proj["index.html"];
    if(proj["style.css"]) html+="<style>"+proj["style.css"]+"</style>";
    if(proj["script.js"]) html+="<script>"+proj["script.js"]+"<\/script>";
    document.getElementById('previewFrame').srcdoc=html;
    document.getElementById('previewArea').style.display='block';
  }
  function closePreview(){document.getElementById('previewArea').style.display='none';}

  // EVENTS
  document.addEventListener('DOMContentLoaded',()=>{
    document.getElementById('signUpBtn').addEventListener('click',signUp);
    document.getElementById('logInBtn').addEventListener('click',logIn);
    document.getElementById('logoutBtn').addEventListener('click',logout);
    document.getElementById('newProjectBtn').addEventListener('click',()=>{
      let name=prompt('Project name?');
      if(name) createProject(name);
    });
    document.getElementById('addFileBtn').addEventListener('click',addFile);
    document.getElementById('saveBtn').addEventListener('click',saveFile);
    document.getElementById('previewBtn').addEventListener('click',previewProject);
    document.getElementById('closePreviewBtn').addEventListener('click',closePreview);
  });
</script>
</body>
</html>
