<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SkyNexaHost with Friends + Chat</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
  <style>
    body {margin:0;font-family:'Poppins',sans-serif;background:#000;color:#fff;}
    .container {padding:20px;}
    .rainbow {
      background: linear-gradient(90deg, #00f, #0ff, #0f0, #ff0, #f0f, #f00);
      background-size: 600% 600%;
      animation: rainbow 8s ease infinite;
      color:#000;padding:8px 16px;border:none;border-radius:8px;cursor:pointer;
    }
    @keyframes rainbow {0%{background-position:0% 50%}50%{background-position:100% 50%}100%{background-position:0% 50%}}
    .friend-row{display:flex;align-items:center;justify-content:space-between;
      padding:10px;border:1px solid rgba(255,255,255,.1);border-radius:10px;margin:6px 0;}
    .friend-left{display:flex;align-items:center;gap:10px;}
    .friend-left img{width:40px;height:40px;border-radius:50%;}
    .modal{display:none;position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,.6);
      align-items:center;justify-content:center;z-index:100;}
    .modal-card{background:#1a1a1a;padding:20px;border-radius:15px;box-shadow:0 0 20px #0ff;max-width:600px;width:90%;}
  </style>
</head>
<body>
  <div class="container">
    <h1 style="color:#0ff">SkyNexaHost</h1>
    <h2>Friends List</h2>
    <div id="friendsList"></div>
  </div>

  <!-- Chat Modal -->
  <div class="modal" id="chatModal">
    <div class="modal-card" style="display:flex;flex-direction:column;height:80vh;">
      <h3 style="margin:0 0 10px;color:#0ff">Chat</h3>
      <div id="chatBox" style="flex:1;overflow-y:auto;padding:10px;background:#111;border-radius:8px;margin-bottom:10px"></div>
      <div style="display:flex;gap:8px">
        <input type="text" id="chatInput" placeholder="Type message..."
          style="flex:1;padding:10px;border-radius:10px;border:1px solid rgba(255,255,255,.15);background:#0f0f10;color:#fff">
        <button id="sendChatBtn" class="rainbow">Send</button>
      </div>
      <div style="text-align:right;margin-top:8px">
        <button onclick="closeChat()">Close</button>
      </div>
    </div>
  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js"></script>
  <script>
    // ðŸ”¹ Replace with your Firebase config
    const firebaseConfig = {
      apiKey: "YOUR_API_KEY",
      authDomain: "YOUR_PROJECT.firebaseapp.com",
      databaseURL: "https://YOUR_PROJECT.firebaseio.com",
      projectId: "YOUR_PROJECT",
      storageBucket: "YOUR_PROJECT.appspot.com",
      messagingSenderId: "XXXXXXX",
      appId: "XXXXXXXX"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Demo users (login system er sathe connect korle currentUser set korte hobe)
    const currentUser = "user1";
    const demoFriends = ["user2","user3"];

    // Render friend list
    function renderFriends(){
      const list=document.getElementById("friendsList");
      list.innerHTML="";
      demoFriends.forEach(f=>{
        const row=document.createElement("div");
        row.className="friend-row";
        row.innerHTML=`
          <div class="friend-left">
            <img src="https://i.pravatar.cc/40?u=${f}">
            <div><div>${f}</div><div class="muted">@${f}</div></div>
          </div>
          <button onclick="openChat('${f}')">Chat</button>
        `;
        list.appendChild(row);
      });
    }
    renderFriends();

    let currentChatUser=null;

    function openChat(friend){
      currentChatUser=friend;
      document.getElementById("chatBox").innerHTML="";
      document.getElementById("chatModal").style.display="flex";

      const chatId=[currentUser,friend].sort().join("_");
      db.ref("chats/"+chatId).off(); // clear old listeners
      db.ref("chats/"+chatId).on("child_added",snap=>{
        const msg=snap.val();
        const div=document.createElement("div");
        div.style.margin="6px 0";
        div.innerHTML=`<b style="color:${msg.from===currentUser?"#0ff":"#fff"}">${msg.from}:</b> ${msg.text}`;
        document.getElementById("chatBox").appendChild(div);
        document.getElementById("chatBox").scrollTop=document.getElementById("chatBox").scrollHeight;
      });
    }

    function closeChat(){
      document.getElementById("chatModal").style.display="none";
      currentChatUser=null;
    }

    document.getElementById("sendChatBtn").onclick=function(){
      const text=document.getElementById("chatInput").value.trim();
      if(!text||!currentChatUser) return;
      const chatId=[currentUser,currentChatUser].sort().join("_");
      db.ref("chats/"+chatId).push({
        from:currentUser,
        text,
        time:Date.now()
      });
      document.getElementById("chatInput").value="";
    }
  </script>
</body>
</html>
