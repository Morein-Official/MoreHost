<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>SkyNexaHost — Pro UI</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#05060a;
      --panel:rgba(255,255,255,0.04);
      --accent:#7c5cff;
      --accent-2:#00d4ff;
      --glass:rgba(255,255,255,0.03);
      --glass-2:rgba(255,255,255,0.02);
      --success:#3ee6a1;
      --danger:#ff6b6b;
      --neon: 0 8px 30px rgba(124,92,255,0.14), 0 0 36px rgba(0,212,255,0.06);
    }
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:'Poppins',sans-serif;background:linear-gradient(120deg,#030313 0%, #081024 50%, #00121a 100%);color:#e9eef8}

    /* neon blur background */
    .bg-blur{position:fixed;inset:0;z-index:-1;filter:blur(60px);opacity:0.9;}
    .blob{position:absolute;width:600px;height:600px;border-radius:50%;transform:translate(-50%,-50%);mix-blend-mode:screen;opacity:.9}
    .blob.a{left:10%;top:10%;background:radial-gradient(circle at 30% 30%, #7c5cff55, transparent 40%)}
    .blob.b{left:80%;top:30%;background:radial-gradient(circle at 30% 30%, #00d4ff44, transparent 40%)}
    .blob.c{left:50%;top:80%;background:radial-gradient(circle at 30% 30%, #ff7bd144, transparent 40%)}

    /* app shell */
    .app{display:flex;flex-direction:column;height:100vh;gap:18px;padding:28px}
    .topbar{display:flex;align-items:center;gap:16px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:48px;height:48px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));box-shadow:var(--neon);display:flex;align-items:center;justify-content:center;font-weight:700;color:#021;background:rgba(255,255,255,0.06)}
    .title{font-size:18px;font-weight:600}
    .spacer{flex:1}

    /* panels */
    .card{background:linear-gradient(180deg,var(--panel),var(--glass));border-radius:14px;padding:14px;box-shadow:0 6px 30px rgba(3,6,12,0.6);backdrop-filter:blur(8px);border:1px solid rgba(255,255,255,0.03)}

    /* layout */
    .main{display:flex;gap:18px;flex:1}
    .left{width:320px;display:flex;flex-direction:column;gap:12px}
    .right{flex:1;display:flex;flex-direction:column;gap:12px}

    /* auth + dashboard styles */
    .auth-panel{max-width:420px;margin:auto}
    .auth-panel h2{margin:0 0 8px 0}
    .form-row{display:flex;flex-direction:column;gap:8px;margin-bottom:10px}
    input[type=text],input[type=password]{background:transparent;border:1px solid rgba(255,255,255,0.06);padding:12px;border-radius:10px;color:inherit}

    /* buttons - unified */
    .btn{display:inline-flex;align-items:center;gap:10px;padding:10px 14px;border-radius:10px;border:none;cursor:pointer;font-weight:600;transition:all .24s ease;box-shadow:0 6px 20px rgba(2,6,12,0.6)}
    .btn:focus{outline:none}
    .btn--primary{background:linear-gradient(90deg,var(--accent),var(--accent-2));color:#051;box-shadow:0 8px 30px rgba(124,92,255,0.12)}
    .btn--ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:inherit}
    .btn--danger{background:linear-gradient(90deg,#ff7b7b,#ff6b6b);color:#fff}
    /* hover glow */
    .btn:hover{transform:translateY(-4px);box-shadow:0 18px 40px rgba(0,0,0,0.6),0 0 34px rgba(124,92,255,0.12);}

    /* project list */
    .projects{display:flex;flex-direction:column;gap:10px}
    .project-box{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:10px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);border:1px solid rgba(255,255,255,0.02);cursor:pointer}
    .project-box:hover{transform:translateY(-4px);}

    /* sidebar file list */
    .files{display:flex;flex-direction:column;gap:8px;padding:8px}
    .file-item{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px}
    .file-item:hover{background:rgba(255,255,255,0.02)}
    .file-item .delete{background:transparent;border:none;color:var(--danger);cursor:pointer}

    /* editor area */
    .editor-top{display:flex;gap:8px;align-items:center}
    #editor{height:520px;border-radius:10px;overflow:hidden}

    /* preview overlay */
    .preview-full{position:fixed;inset:0;z-index:60;background:#050712;display:flex;align-items:center;justify-content:center}
    .preview-full iframe{width:100%;height:100%;border:none}
    .close-preview{position:absolute;top:18px;right:18px}

    /* loader */
    .loader-screen{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;z-index:80;background:linear-gradient(180deg,#000 0%,rgba(2,4,12,0.6) 100%)}
    .loader-box{width:520px;max-width:92%;padding:28px;border-radius:16px;text-align:center;background:linear-gradient(90deg,rgba(255,255,255,0.03),rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.03)}
    .spinner{width:72px;height:72px;border-radius:50%;border:8px solid rgba(255,255,255,0.04);border-top-color:var(--accent);margin:16px auto;animation:spin 1.1s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}

    /* small screens */
    @media(max-width:880px){.left{display:none}.topbar{padding:6px}.editor-top{flex-direction:column;align-items:stretch}#editor{height:380px}}
  </style>
</head>
<body>
  <div class="bg-blur">
    <div class="blob a"></div>
    <div class="blob b"></div>
    <div class="blob c"></div>
  </div>

  <!-- Loader: 4 seconds with dialog messages -->
  <div id="loader" class="loader-screen" aria-hidden="false">
    <div class="loader-box card">
      <div style="font-size:20px;font-weight:700">SkyNexaHost</div>
      <div id="loader-msg" style="margin-top:10px;opacity:0.9">Preparing your creative space...</div>
      <div class="spinner"></div>
      <div style="font-size:13px;opacity:0.7">Loading assets • Initializing editor • Setting neon vibes</div>
    </div>
  </div>

  <div class="app" id="app" style="display:none">
    <div class="topbar">
      <div class="brand">
        <div class="logo">SN</div>
        <div>
          <div class="title">SkyNexaHost</div>
          <div style="font-size:12px;opacity:0.7">Mini-hosting • Live IDE</div>
        </div>
      </div>
      <div class="spacer"></div>
      <div id="user-area" style="display:flex;gap:8px;align-items:center"></div>
    </div>

    <div class="main">
      <div class="left">
        <div class="card auth-panel" id="auth-panel">
          <!-- Auth forms injected here -->
        </div>

        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
            <div style="font-weight:700">Projects</div>
            <button class="btn btn--primary" id="new-project">+ New</button>
          </div>
          <div class="projects" id="projects-list">
            <!-- project boxes -->
          </div>
        </div>

        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
            <div style="font-weight:700">Ready Codes</div>
            <button class="btn btn--ghost" id="open-ready">Open</button>
          </div>
          <div style="font-size:13px;opacity:0.8">Small library of templates & snippets to copy</div>
        </div>
      </div>

      <div class="right">
        <div class="card">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div style="font-weight:700">Workspace</div>
            <div style="display:flex;gap:8px">
              <button class="btn btn--ghost" id="toggle-sidebar">Toggle Files</button>
              <button class="btn btn--ghost" id="logout-btn" style="display:none">Logout</button>
            </div>
          </div>

          <div style="display:flex;gap:12px;margin-top:12px">
            <div style="width:260px;max-width:40%" id="files-panel">
              <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
                <div style="font-weight:600">Files</div>
                <div style="display:flex;gap:6px">
                  <input id="new-file-name" placeholder="file name (e.g. index.html)" style="padding:8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04)">
                  <button class="btn btn--primary" id="add-file">Add</button>
                </div>
              </div>
              <div class="files card" id="files-list" style="max-height:420px;overflow:auto"></div>
            </div>

            <div style="flex:1;display:flex;flex-direction:column">
              <div class="editor-top">
                <div style="display:flex;gap:8px;align-items:center">
                  <select id="file-mode" style="padding:8px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04)">
                    <option value="html">HTML</option>
                    <option value="css">CSS</option>
                    <option value="js">JS</option>
                  </select>
                  <div id="current-file" style="font-weight:700">No file selected</div>
                </div>
                <div class="spacer"></div>
                <div style="display:flex;gap:8px">
                  <button class="btn btn--ghost" id="save-file">Save</button>
                  <button class="btn btn--primary" id="preview-btn">Preview</button>
                </div>
              </div>

              <div id="editor" class="card">Loading editor...</div>
            </div>
          </div>
        </div>

        <div class="card" style="padding:10px;display:flex;gap:12px;align-items:center">
          <div style="font-size:13px;opacity:0.8">Tips: index.html is required to Preview. Allowed: .html .css .js</div>
          <div class="spacer"></div>
          <div id="status-area" style="font-weight:700"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Preview overlay -->
  <div id="preview" class="preview-full" style="display:none">
    <button class="btn close-preview btn--ghost" id="close-preview">Close</button>
    <iframe id="preview-frame"></iframe>
  </div>

  <!-- Ready codes modal -->
  <div id="ready-modal" style="display:none;position:fixed;inset:0;z-index:70;align-items:center;justify-content:center;background:rgba(0,0,0,0.6)">
    <div style="width:860px;max-width:96%;padding:18px;border-radius:12px;background:linear-gradient(180deg,rgba(255,255,255,0.02),transparent);">
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px">
        <div style="font-weight:700">Ready Codes</div>
        <button class="btn btn--ghost" id="close-ready">Close</button>
      </div>
      <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
        <div class="card" style="padding:12px">
          <div style="font-weight:700">Simple Navbar</div>
          <pre id="snippet1" style="white-space:pre-wrap;font-size:13px;margin-top:8px">&lt;nav&gt; &lt;ul&gt;&lt;li&gt;Home&lt;/li&gt;&lt;/ul&gt;&lt;/nav&gt;</pre>
          <button class="btn btn--primary" data-snippet="snippet1">Copy</button>
        </div>
        <div class="card" style="padding:12px">
          <div style="font-weight:700">Minimal JS Alert</div>
          <pre id="snippet2" style="white-space:pre-wrap;font-size:13px;margin-top:8px">console.log('Hello from Ready Codes')</pre>
          <button class="btn btn--primary" data-snippet="snippet2">Copy</button>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.15.2/ace.js" integrity="" crossorigin="anonymous"></script>
  <script>
    // Simple 4-second loader with rotating messages
    const loader = document.getElementById('loader');
    const loaderMsg = document.getElementById('loader-msg');
    const messages = ['Preparing your creative space...','Warming up the neon editor...','Loading templates & snippets...','Finalizing your desk setup...'];
    let idx = 0;
    const msgInterval = setInterval(()=>{ idx=(idx+1)%messages.length; loaderMsg.textContent=messages[idx]; },900);
    setTimeout(()=>{
      clearInterval(msgInterval);
      loader.style.display='none';
      document.getElementById('app').style.display='flex';
      initApp();
    },4000);

    // App state & helpers
    const allowedExt = ['html','css','js'];
    let editor = null;
    let currentUser = null;
    let currentProject = null;
    let currentFile = null; // filename

    function qs(sel){return document.querySelector(sel)}
    function qid(id){return document.getElementById(id)}

    function initApp(){
      // initialize editor
      editor = ace.edit('editor');
      editor.setTheme('ace/theme/monokai');
      editor.session.setMode('ace/mode/html');
      editor.setOptions({fontSize:'14px',enableBasicAutocompletion:true,enableSnippets:true,enableLiveAutocompletion:true});

      // hook UI
      renderAuthPanel();
      bindUI();

      // if user logged in -> go to dashboard
      const stored = localStorage.getItem('skynexa_user');
      if(stored){
        try{ const data=JSON.parse(stored); if(data.username){ currentUser=data.username; showDashboard(); return; } }
        catch(e){}
      }
      // else show auth panel automatically (already rendered)
    }

    function bindUI(){
      qid('toggle-sidebar').addEventListener('click',()=>{
        const filesPanel = qid('files-panel'); filesPanel.style.display = filesPanel.style.display==='none'?'block':'none';
      });

      qid('new-project').addEventListener('click',()=>{
        const name = prompt('New project name'); if(!name) return;
        createProject(name);
      });

      qid('open-ready').addEventListener('click',()=>{ qid('ready-modal').style.display='flex'; });
      qid('close-ready').addEventListener('click',()=>{ qid('ready-modal').style.display='none'; });
      document.querySelectorAll('#ready-modal button[data-snippet]').forEach(btn=>{
        btn.addEventListener('click',()=>{ const id=btn.getAttribute('data-snippet'); navigator.clipboard.writeText(document.getElementById(id).textContent); alert('Copied snippet'); });
      });

      qid('add-file').addEventListener('click',()=>{ const name = qid('new-file-name').value.trim(); addFile(name); qid('new-file-name').value=''; });
      qid('save-file').addEventListener('click',()=> saveCurrentFile());
      qid('preview-btn').addEventListener('click',()=> previewProject());
      qid('close-preview').addEventListener('click',()=> qid('preview').style.display='none');

      qid('logout-btn').addEventListener('click',()=>{ logout(); });
    }

    // AUTH
    function renderAuthPanel(){
      const panel = qid('auth-panel');
      panel.innerHTML = `
        <h2>Welcome to SkyNexaHost</h2>
        <div style="opacity:0.8;margin-bottom:12px">Sign up or log in to start coding. Your data stays in your browser.</div>
        <div class="form-row"><input id="auth-name" type="text" placeholder="username"></div>
        <div class="form-row"><input id="auth-pass" type="password" placeholder="password"></div>
        <div style="display:flex;gap:8px"><button class="btn btn--primary" id="signup-btn">Sign Up</button><button class="btn btn--ghost" id="login-btn">Log In</button></div>
      `;
      qid('signup-btn').addEventListener('click',()=>{
        const u = qid('auth-name').value.trim(); const p = qid('auth-pass').value.trim(); if(!u||!p){alert('Provide username & password');return}
        const key = 'skynexa_user_'+u;
        if(localStorage.getItem(key)){alert('User exists — try login'); return}
        localStorage.setItem(key, JSON.stringify({username:u,password:p,projects:{}}));
        localStorage.setItem('skynexa_user',JSON.stringify({username:u}));
        currentUser = u; showDashboard();
      });
      qid('login-btn').addEventListener('click',()=>{
        const u = qid('auth-name').value.trim(); const p = qid('auth-pass').value.trim(); if(!u||!p){alert('Provide username & password');return}
        const key = 'skynexa_user_'+u; const raw = localStorage.getItem(key); if(!raw){alert('No such user — sign up first');return}
        const info = JSON.parse(raw); if(info.password!==p){alert('Wrong password');return}
        localStorage.setItem('skynexa_user',JSON.stringify({username:u})); currentUser=u; showDashboard();
      });
    }

    function showDashboard(){
      // hide auth panel and show dashboard content
      qid('auth-panel').style.display='none';
      qid('logout-btn').style.display='inline-flex';
      updateUserArea();
      renderProjects();
      updateStatus('Welcome, '+currentUser);
    }

    function updateUserArea(){
      const ua = qid('user-area'); ua.innerHTML = '';
      const name = document.createElement('div'); name.textContent = currentUser; name.style.opacity=0.9; name.style.fontWeight=700;
      const out = document.createElement('button'); out.className='btn btn--ghost'; out.textContent='Logout'; out.addEventListener('click',logout);
      ua.appendChild(name); ua.appendChild(out);
    }

    function logout(){ localStorage.removeItem('skynexa_user'); currentUser=null; location.reload(); }

    // Projects & Files
    function getUserData(){ const key='skynexa_user_'+currentUser; const raw=localStorage.getItem(key); return raw?JSON.parse(raw):{username:currentUser,password:'',projects:{}} }
    function saveUserData(data){ const key='skynexa_user_'+currentUser; localStorage.setItem(key,JSON.stringify(data)); }

    function renderProjects(){
      const list = qid('projects-list'); list.innerHTML=''; const data=getUserData(); const projects = data.projects||{};
      if(Object.keys(projects).length===0) list.innerHTML='<div style="opacity:0.8">No projects yet — create one!</div>';
      Object.keys(projects).forEach(name=>{
        const box = document.createElement('div'); box.className='project-box'; box.innerHTML=`<div>${name}</div><div style="display:flex;gap:8px"><button class='btn btn--ghost open'>Open</button><button class='btn btn--danger delete'>Delete</button></div>`;
        box.querySelector('.open').addEventListener('click',()=> openProject(name));
        box.querySelector('.delete').addEventListener('click',()=>{ if(confirm('Delete project?')){ deleteProject(name); } });
        list.appendChild(box);
      });
    }

    function createProject(name){ const data=getUserData(); if(data.projects[name]){alert('Project exists');return} data.projects[name]={files:{}}; saveUserData(data); renderProjects(); updateStatus('Project created: '+name); }
    function deleteProject(name){ const data=getUserData(); delete data.projects[name]; saveUserData(data); renderProjects(); if(currentProject===name){currentProject=null; qid('files-list').innerHTML=''; qid('current-file').textContent='No file selected'; editor.setValue(''); }
    }

    function openProject(name){ currentProject=name; renderFiles(); updateStatus('Opened '+name); }

    function renderFiles(){ const filesList = qid('files-list'); filesList.innerHTML=''; if(!currentProject){ filesList.innerHTML='<div style="opacity:0.8">Open a project to view files</div>'; return }
      const data=getUserData(); const files = data.projects[currentProject].files||{}; if(Object.keys(files).length===0) filesList.innerHTML='<div style="opacity:0.8">No files — add index.html to preview</div>';
      Object.keys(files).forEach(fname=>{
        const row = document.createElement('div'); row.className='file-item'; row.innerHTML=`<div style="display:flex;gap:10px;align-items:center"><div style="width:10px;height:10px;border-radius:50%;background:linear-gradient(90deg,var(--accent),var(--accent-2))"></div><div style="font-weight:600">${fname}</div></div><div><button class='btn btn--ghost open'>Open</button><button class='delete' title='Delete'>✖</button></div>`;
        row.querySelector('.open').addEventListener('click',()=> openFile(fname));
        row.querySelector('.delete').addEventListener('click',()=>{ if(confirm('Delete file?')){ deleteFile(fname); } });
        filesList.appendChild(row);
      });
    }

    function addFile(name){ if(!currentProject){alert('Open a project first');return} if(!name){alert('Provide file name');return}
      const parts = name.split('.'); if(parts.length<2){alert('Add extension e.g. index.html');return}
      const ext = parts.pop().toLowerCase(); if(!allowedExt.includes(ext)){alert('Invalid extension');return}
      const data=getUserData(); const files=data.projects[currentProject].files||{}; if(files[name]){alert('File exists');return}
      files[name]=''; data.projects[currentProject].files=files; saveUserData(data); renderFiles(); updateStatus('File added: '+name);
    }

    function openFile(name){ const data=getUserData(); const content=data.projects[currentProject].files[name]; currentFile=name; qid('current-file').textContent=name; const ext=name.split('.').pop(); setEditorMode(ext); editor.setValue(content||'', -1);
    }

    function deleteFile(name){ const data=getUserData(); delete data.projects[currentProject].files[name]; saveUserData(data); renderFiles(); if(currentFile===name){ currentFile=null; editor.setValue(''); qid('current-file').textContent='No file selected'; }
    }

    function setEditorMode(ext){ if(ext==='html'){ editor.session.setMode('ace/mode/html'); qid('file-mode').value='html' }
      else if(ext==='css'){ editor.session.setMode('ace/mode/css'); qid('file-mode').value='css' }
      else if(ext==='js'){ editor.session.setMode('ace/mode/javascript'); qid('file-mode').value='js' }
    }

    function saveCurrentFile(){ if(!currentProject||!currentFile){ alert('No file selected'); return }
      const data=getUserData(); data.projects[currentProject].files[currentFile]=editor.getValue(); saveUserData(data); updateStatus('Saved '+currentFile);
    }

    function previewProject(){ if(!currentProject){alert('Open a project to preview');return}
      const data=getUserData(); const files = data.projects[currentProject].files||{}; if(!files['index.html']){alert('index.html missing — cannot preview');return}
      // build html
      const html = files['index.html']; const css = files['style.css']?`<style>${files['style.css']}</style>`:''; const js = files['script.js']?`<script>${files['script.js']}</script>`:'';
      const full = `<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1">${css}</head><body>${html}${js}</body></html>`;
      const iframe = qid('preview-frame'); iframe.srcdoc = full; qid('preview').style.display='flex';
    }

    function updateStatus(msg){ qid('status-area').textContent = msg; setTimeout(()=>{ if(qid('status-area').textContent===msg) qid('status-area').textContent=''; },2800); }

    // local helper for creating demo project automatically when logged in first time
    window.addEventListener('load',()=>{
      // if loader already removed and user logged in, handle redirect
      const stored = localStorage.getItem('skynexa_user'); if(stored){ try{ const data=JSON.parse(stored); if(data.username){ currentUser=data.username; showDashboard(); } }catch(e){}
      }
    });
  </script>
</body>
</html>
