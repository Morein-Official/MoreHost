<script>
let currentGame=null,ctx,canvas=document.getElementById("gameCanvas");
let loop;

// ========== MENU ==========
function startGame(game){
  document.querySelector(".game-list").style.display="none";
  document.getElementById("gameArea").style.display="flex";
  document.getElementById("gameTitle").innerText=game.toUpperCase();
  ctx=canvas.getContext("2d");
  currentGame=game;
  if(game==="snake") initSnake();
  if(game==="tic") initTic();
  if(game==="flappy") initFlappy();
}
function backToMenu(){
  clearInterval(loop);
  document.getElementById("gameArea").style.display="none";
  document.querySelector(".game-list").style.display="flex";
}

// ========== SNAKE ==========
let snake,dir,food;
function initSnake(){
  snake=[{x:140,y:140}];
  dir=null;
  food={x:Math.floor(Math.random()*30)*10,y:Math.floor(Math.random()*30)*10};
  clearInterval(loop);
  loop=setInterval(updateSnake,200); // ⬅ slow speed (100 → 200)
}
function updateSnake(){
  ctx.fillStyle="black";ctx.fillRect(0,0,300,300);
  for(let s of snake){ctx.fillStyle="lime";ctx.fillRect(s.x,s.y,10,10);}
  ctx.fillStyle="red";ctx.fillRect(food.x,food.y,10,10);
  let head={...snake[0]};
  if(dir==="LEFT") head.x-=10;
  if(dir==="RIGHT") head.x+=10;
  if(dir==="UP") head.y-=10;
  if(dir==="DOWN") head.y+=10;
  if(head.x===food.x && head.y===food.y){
    food={x:Math.floor(Math.random()*30)*10,y:Math.floor(Math.random()*30)*10};
  } else {snake.pop();}
  snake.unshift(head);
  if(head.x<0||head.y<0||head.x>=300||head.y>=300||snake.slice(1).some(s=>s.x===head.x&&s.y===head.y)){
    alert("Game Over!"); initSnake();
  }
}

// ========== TIC TAC TOE ==========
let board,current;
function initTic(){
  board=Array(9).fill(null);
  current="X";
  clearInterval(loop);
  loop=setInterval(updateTic,100);
  canvas.onclick=e=>{
    let rect=canvas.getBoundingClientRect();
    let x=Math.floor((e.clientX-rect.left)/100),y=Math.floor((e.clientY-rect.top)/100);
    let idx=y*3+x;
    if(!board[idx]) board[idx]=current,current=current==="X"?"O":"X";
  };
}
function updateTic(){
  ctx.fillStyle="#111";ctx.fillRect(0,0,300,300);
  ctx.strokeStyle="white";
  for(let i=1;i<3;i++){ctx.beginPath();ctx.moveTo(i*100,0);ctx.lineTo(i*100,300);
    ctx.moveTo(0,i*100);ctx.lineTo(300,i*100);ctx.stroke();}
  for(let i=0;i<9;i++){if(board[i]){ctx.fillStyle="cyan";ctx.font="60px Poppins";ctx.fillText(board[i],(i%3)*100+30,Math.floor(i/3)*100+70);}}
}

// ========== FLAPPY ==========
let birdY,vel,pipes,birdX;
function initFlappy(){
  birdX=50;birdY=150;vel=0;pipes=[{x:300,y:Math.random()*150+50}];
  clearInterval(loop);
  loop=setInterval(updateFlappy,50);
  document.onkeydown=e=>{ if(e.code==="Space"){ flap(); } };
}
function flap(){
  vel=-8;
  birdX=Math.max(0,birdX-5); // ⬅ ছোট্ট Left move
}
function updateFlappy(){
  ctx.fillStyle="#222";ctx.fillRect(0,0,300,300);
  vel+=0.5;birdY+=vel;
  ctx.fillStyle="yellow";ctx.fillRect(birdX,birdY,20,20);
  for(let i=0;i<pipes.length;i++){
    ctx.fillStyle="green";
    ctx.fillRect(pipes[i].x,0,30,pipes[i].y);
    ctx.fillRect(pipes[i].x,pipes[i].y+60,30,300);
    pipes[i].x-=2;
    if(pipes[i].x===150)pipes.push({x:300,y:Math.random()*150+50});
    if(birdX<pipes[i].x+30&&birdX+20>pipes[i].x&&
       (birdY<pipes[i].y||birdY+20>pipes[i].y+60)){
      alert("Game Over!");initFlappy();
    }
  }
  if(birdY>300||birdY<0){alert("Game Over!");initFlappy();}
}

// ========== CONTROLS ==========
function setDir(d){dir=d;}
document.addEventListener("keydown",e=>{
  if(currentGame==="snake"){
    if((e.key==="a"||e.key==="ArrowLeft")&&dir!=="RIGHT")dir="LEFT";
    if((e.key==="d"||e.key==="ArrowRight")&&dir!=="LEFT")dir="RIGHT";
    if((e.key==="w"||e.key==="ArrowUp")&&dir!=="DOWN")dir="UP";
    if((e.key==="s"||e.key==="ArrowDown")&&dir!=="UP")dir="DOWN";
  }
  if(currentGame==="flappy" && e.code==="Space"){ flap(); }
});
</script>



